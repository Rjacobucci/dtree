{
    "collab_server" : "",
    "contents" : "library(foreign)\n\n\ndiag.dat <- read.spss(\"C:/Users/RJacobucci/Dropbox/dissertation/adams1waveasav/ADAMS1AD_R.sav\",\n                  to.data.frame=TRUE)\n\ndiag.dat <- read.spss(\"C:/Users/Ross/Dropbox/dissertation/adams1waveasav/ADAMS1AD_R.sav\",\n                      to.data.frame=TRUE)\n\n\ntable(diag.dat$ADFDX1)\n# see Langa 2005 for further categorization\n\n# normal=31\n\ndiag <- rep(\"none\",nrow(diag.dat))\n\n# demented\ndiag[diag.dat$ADFDX1 %in% c(1:8,10,13:19)] <- \"dement\"\n\n# CIND\n\ndiag[diag.dat$ADFDX1 %in% c(20:22,28,29:30,23,24,25,26,27)] <- \"cind\"\n\ntable(diag)\n\n######### get hrs id ##############\n\nab.dat <- read.spss(\"C:/Users/RJacobucci/Dropbox/dissertation/adams1waveasav/ADAMS1AB_R.sav\",\n                    to.data.frame=TRUE)\nab.dat <- read.spss(\"C:/Users/Ross/Dropbox/dissertation/adams1waveasav/ADAMS1AB_R.sav\",\n                    to.data.frame=TRUE)\nids <- cbind(ab.dat[,1:3],diag)\n\n\n########### IADL/ADL ##################3\n\n# has more missing data\nag.dat <- read.spss(\"C:/Users/RJacobucci/Dropbox/dissertation/adams1waveasav/ADAMS1AG_R.sav\",\n                    to.data.frame=TRUE)\n\nag.dat <- read.spss(\"C:/Users/Ross/Dropbox/dissertation/adams1waveasav/ADAMS1AG_R.sav\",\n                    to.data.frame=TRUE)\n\niadl <- ag.dat[,c(\"HHID\",\"PN\",\"AGQ30B\",\"AGQ30C\",\"AGQ30D\",\"AGQ30F\")]\n\niadl[,3] <- factor(iadl[,3])\niadl[,4] <- factor(iadl[,4])\niadl[,5] <- factor(iadl[,5])\niadl[,6] <- factor(iadl[,6])\n\n\nadams.dat <- merge(ids,iadl)\n\n\n#### adams cognitive measures ########\n\n\nad.dat <- read.spss(\"C:/Users/RJacobucci/Dropbox/dissertation/adams1waveasav/ADAMS1AD_R.sav\",\n                    to.data.frame=TRUE)\n\nad.dat <- read.spss(\"C:/Users/Ross/Dropbox/dissertation/adams1waveasav/ADAMS1AD_R.sav\",\n                    to.data.frame=TRUE)\n\n\ncog.adams <- ad.dat[,c(\"HHID\",\"PN\",\"ADBLSCOR\")]\n\n\n\n\nan.dat <- read.spss(\"C:/Users/RJacobucci/Dropbox/dissertation/adams1waveasav/ADAMS1AN_R.sav\",\n                    to.data.frame=TRUE)\n\nan.dat <- read.spss(\"C:/Users/Ross/Dropbox/dissertation/adams1waveasav/ADAMS1AN_R.sav\",\n                    to.data.frame=TRUE)\n\n\ncog.adams2 <- an.dat[,c(\"HHID\",\"PN\",\"ANAFTOT\",\"ANDSTOT\")]\n\n\n\n########## combine adams ##################3\n\n\nadams1 <- merge(cog.adams,cog.adams2)\nadams2 <- merge(adams1,iadl) # iadl is missing observations\nadams3 <- merge(adams2,adams.dat)\n#############################################################\n\n############ HRS Dataset #############################\n\n#########################################################333\n\n#### HRS 2002 is Wave 6, 2000 is Wave 5\n\n####### need weight ###########333333\n\n\n\nlibrary(foreign)\ndat <- read.spss(\"/Users/RJacobucci/Documents/hrs_longitudinal/rndhrs_o.sav\",\n                 to.data.frame=TRUE)\n\ndat <- read.spss(\"/Users/Ross/Documents/rndhrs_o.sav\",\n                 to.data.frame=TRUE)\n\n\n\n\ndat2 <- dat[,c(\"HHID\",\"PN\",\"RAEDYRS\",\"RARACEM\",\"RAHISPAN\",\"RAGENDER\",\"R5TR20\",\"R6TR20\",\"R6PROXY\",\n               \"R5MSTOT\",\"R6MSTOT\",\"R5COGTOT\",\"R6COGTOT\",\"R5SHLT\",\"R6SHLT\",\"R5SER7\",\"R6SER7\")]\n              # \"RAWTSAMP\")]\n\nmatch.ids <- merge(adams3,dat2)\n\nmatch.ids2 <- match.ids[,-which(names(match.ids) %in% c(\"HHID\",\"PN\",\"ADAMSSID\"))]\n\nids <- match.ids2$R6PROXY==\"0.not proxy\" & is.na(match.ids2$R6PROXY)==FALSE\nmatch.ids3 <- match.ids2[ids,]\n\n\nlibrary(mice)\nout2 = mice(match.ids3,m=1,defaultMethod=c(\"cart\",\"cart\",\"cart\"))\nmatch.ids4 = complete(out2)\n\n\n#match.ids5 <- match.ids4[,-24]\nmatch.ids4$diag\nout.dtree <- dtree(diag ~ ., match.ids4,methods=c(\"lm\",\"rpart\",\"ctreePrune\",\"ctree\",\"rf\"),tuneLength=7)\nsummary(out.dtree)\n\nout.stable <- stable(diag~., match.ids4,methods=c(\"rpart\",\"ctreePrune\",\"ctree\"))\n\nsave.image(\"out_dtree_hrs2.RData\")\n\n\nout.rf <- train(diag ~., match.ids4,method=\"parRF\",tuneLength=7,trControl=trainControl(method=\"repeatedcv\",repeats=10))\n\nmatch.ids4$diag == \"cind\" | match.ids4$diag == \"none\" | match.ids4$diag == \"dement\"\n\n\n######## change to multinomial\nlibrary(nnet)\nmod <- multinom(diag ~ ., match.ids4)\n\ntt <- adams3[complete.cases(adams3),]\npp = predict(mod)\nlibrary(caret)\n#confusionMatrix(tt$diag,pp)\ntable(tt$diag,pp)\n\n\n\n\n\nout<-dtree(diag ~ ., match.ids5,methods=c(\"rpart\",\"ctreePrune\"))\n\n\n\n\n\n\nadams.tt = adams3[complete.cases(adams3),-c(1,10)]\n\n\nmod2 <- glm(diag ~ ., adams.tt,family = 'logit')\n\n\n\nlibrary(rpart)\nrpart.out <- rpart(diag ~., adams.tt)\nrpart.out\n",
    "created" : 1492724090271.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4260605245",
    "id" : "EE202FB6",
    "lastKnownWriteTime" : 1492745816,
    "last_content_update" : 1492745816276,
    "path" : "~/GitHub/diss_paper/analyses/demo/adams_demo.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}