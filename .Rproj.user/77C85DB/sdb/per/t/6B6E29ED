{
    "collab_server" : "",
    "contents" : "CtreePathFunc <- function (ct, data) {\n\n  ResulTable <- data.frame(Node = character(), Path = character())\n\n  for(Node in unique(where(ct))){\n    # Taking all possible non-Terminal nodes that are smaller than the selected terminal node\n    NonTerminalNodes <- setdiff(1:(Node - 1), unique(where(ct))[unique(where(ct)) < Node])\n\n\n    # Getting the weigths for that node\n    NodeWeights <- nodes(ct, Node)[[1]]$weights\n\n\n    # Finding the path\n    Path <- NULL\n    for (i in NonTerminalNodes){\n      if(any(NodeWeights & nodes(ct, i)[[1]][2][[1]] == 1)) Path <- append(Path, i)\n    }\n\n    # Finding the splitting creteria for that path\n    Path2 <- SB <- NULL\n\n    for(i in 1:length(Path)){\n      if(i == length(Path)) {\n        n <- nodes(ct, Node)[[1]]\n      } else {n <- nodes(ct, Path[i + 1])[[1]]}\n\n      if(all(data[which(as.logical(n$weights)), as.character(unlist(nodes(ct,Path[i])[[1]][[5]])[length(unlist(nodes(ct,Path[i])[[1]][[5]]))])] <= as.numeric(unlist(nodes(ct,Path[i])[[1]][[5]])[3]))){\n        SB <- \"<=\"\n      } else {SB <- \">\"}\n      Path2 <- paste(c(Path2, paste(as.character(unlist(nodes(ct,Path[i])[[1]][[5]])[length(unlist(nodes(ct,Path[i])[[1]][[5]]))]),\n                                    SB,\n                                    as.character(unlist(nodes(ct,Path[i])[[1]][[5]])[3]))),\n                     collapse = \", \")\n    }\n\n    # Output\n    ResulTable <- rbind(ResulTable, cbind(Node = Node, Path = Path2))\n  }\n  return(ResulTable)\n\n}\n\n\n#yy = CtreePathFunc(tt,data)\n\n\n#for(i in 1:nrow(yy)){\n#  pp <- list()\n#  pp <- c(pp,unique(unlist(strsplit(levels(yy[i,2]), \",\"))))\n#}\n\n#matt <- matrix(NA,length(pp),2)\n#for(j in 1:length(pp)){\n#\n#  rr <- strsplit(pp[[j]],\"[> <= ]\" )\n#  rr2 <- rr[[1]][rr[[1]]!=\"\"]\n#  matt[j,1] <- rr2[1]\n#  matt[j,2] <- as.numeric(rr2[2])\n#}\n\n",
    "created" : 1490210257098.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2753096651",
    "id" : "6B6E29ED",
    "lastKnownWriteTime" : 1490286211,
    "last_content_update" : 1490286211385,
    "path" : "~/GitHub/dtree/R/ctree_table.R",
    "project_path" : "R/ctree_table.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}