{
    "collab_server" : "",
    "contents" : "library(MASS);library(lavaan);library(psych);library(ISLR);library(dtree);library(mice)\n####\nHS <- HolzingerSwineford1939[complete.cases(HolzingerSwineford1939),-c(1,4)]\nnames(HS)[3] <- \"y\"\nHS$y <- as.factor(HS$y)\nHS$sex <- as.factor(HS$sex)\nHS$ageyr <- as.factor(HS$ageyr)\nHS$grade <- as.factor(HS$grade)\nHS[,5:13] <- round(HS[,5:13],1)\nlevels(HS$y) <- c(\"GW\",\"P\")\n\n####\nFB2 <- FacialBurns[,-c(2)]\nnames(FB2)[1] <- \"y\"\nFB2$Sex <- as.factor(FB2$Sex)\n\n\n#####\n\nbfi2 <- bfi[complete.cases(bfi),-c(27:28)]\nbfi2$gender <- as.factor(bfi2$gender)\nnames(bfi2)[26] <- \"y\"\nlevels(bfi2$y) <- c(\"M\",\"F\")\nbfi3 <- bfi2[1:1000,c(1:10,26)]\n#####\n\neb2 <- epi.bfi[,1:11]\nnames(eb2)[11] <- \"y\"\n\n#####\n\nnames(crabs)[1] <- \"y\"\ncrabs2 <- crabs[,-c(2,3)]\n\n#####\n\nnames(Wage)[12] <- \"y\"\nWage2 <- Wage[1:1000,-11]\n\n\n#####\n\nnames(cats)[1] <- \"y\"\n\n#####\n\n\nCars932 <- Cars93[complete.cases(Cars93),-c(1,2,27)]\n# predict origin\nnames(Cars932)[24] <- \"y\"\nlevels(Cars932$y) <- c(\"USA\",\"nUSA\")\n\n######\nBoston$chas <- as.factor(Boston$chas)\nnames(Boston)[14] <- \"y\"\n\n######\nbirthwt2 <- birthwt[,-10]\nbirthwt2$low <- as.factor(birthwt2$low)\nnames(birthwt2)[1] <- \"y\"\nbirthwt2$ptl<- as.factor(birthwt2$ptl)\nbirthwt2$ht <- as.factor(birthwt2$ht)\nbirthwt2$ui <- as.factor(birthwt2$ui)\nbirthwt2$ftv <- as.factor(birthwt2$ftv)\nlevels(birthwt2$y) <- c(\"low\",\"high\")\n\n######\n\nbiopsy2 <- biopsy[complete.cases(biopsy),-c(1)]\nnames(biopsy2)[10] <- \"y\"\n#levels(biopsy2$y) <- c(\"1\",\"2\")\n######\n\n\nnames(College)[2] <- \"y\" #Apps\nCollege2 <- College[,-c(11:17)]\n#####\nnames(quine)[5] <- \"y\"\n\n#####\n\nnames(Pima.tr)[8] <- \"y\"\n\n#####\n\nOME2 <- OME[,-1]\nOME2$y <- OME2$Correct/OME2$Trials\nOME3 <- OME2[,-c(5:6)]\n\n\n#####\n\nnlschools2 <- nlschools[1:1000,-3]\nnames(nlschools2)[1] <- \"y\"\nstr(nlschools2)\n\n#####\n\nnames(minn38)[2] <- \"y\"\nminn382 <- minn38[,-5]\n\nlevels(minn382$y) <- c(\"C\",\"N\",\"N\",\"N\")\n\n#####\n\nnames(swiss)[1] <- \"y\" #fertility\n\n######\nnames(Default)[1] <- \"y\"\nDefault2 <- Default[1:2000,]\n\n#####\nlibrary(caret)\ndata(Sacramento)\nstr(Sacramento)\n\nnames(Sacramento)[7] <- \"y\"\nSacramento2 <- Sacramento[,-c(1,2,8:9)]\nSacramento2$y <- round(Sacramento2$y,-4)\nSacramento2$sqft <- round(Sacramento2$sqft,-2)\n\n\n\n############ data\nlibrary(beepr)\ndat.list <- list(HS,FB2,bfi3,crabs2,eb2,Wage2,cats,Cars932,Boston,\n                 birthwt2,biopsy2,College2,quine,Pima.tr,OME3,nlschools2,minn382,\n                 swiss,Default2,Sacramento2)\n\ninsert_nas <- function(data,perc) {\n  data2 = data[,!names(data) %in% c(\"y\")]\n\n  for(j in 1:ncol(data2)){\n    len <- length(data2[,j])\n    i <- sample(1:len, floor(perc*len))\n    data2[i,j] <- NA\n  }\n  data.frame(y=data$y,data2)\n}\n\n\n\n\n# problems with nlschools, error with minn382\nmemory.limit(size = 250000)\n\n\n\n\nmissing <- c(.1,.25,.50)\ndat.ind<- c(2,6,7,9)\ncount = 0\nres.stab <- matrix(NA,length(missing)*length(dat.ind)*50,4)\nres.nodes <- matrix(NA,length(missing)*length(dat.ind)*50,4)\nres.nvar <- matrix(NA,length(missing)*length(dat.ind)*50,4)\nres.nsplits <- matrix(NA,length(missing)*length(dat.ind)*50,4)\nres.perf <- matrix(NA,length(missing)*length(dat.ind)*50,4)\n\n\nfor(i in dat.ind){\n  dat <- dat.list[[i]]\n  for(j in 1:50){\n    for(k in 1:length(missing)){\n      count=count+1\n      set.seed(count)\n      print(count)\n      dat2 <-insert_nas(dat,missing[k])\n\n      out2 = mice(dat2,m=1,defaultMethod=c(\"cart\",\"cart\",\"cart\"))\n      df = complete(out2)\n\n      print(system.time(return <- stable(y~., df,methods=c(\"rpart\",\"ctreePrune\"),n.rep=100,\n                       samp.method=\"cv\",tuneLength=3,stablelearner=FALSE,parallel=TRUE,ncore=4)))\n      res.stab[count,] <- c(i,k,return$stability)\n      res.nodes[count,] <- c(i,k,return$means[,\"nodes\"])\n      res.nvar[count,] <- c(i,k,return$means[,\"nvar\"])\n      res.nsplits[count,] <- c(i,k,return$means[,\"nsplits\"])\n\n      if(\"auc.samp\" %in% colnames(return$means)){\n        res.perf[count,] <- c(i,k,return$means[,\"auc.samp\"])\n\n      }else{\n        res.perf[count,] <- c(i,k,return$means[,\"rsq.samp\"])\n      }\n    }\n  }\n}\nsave.image(\"missing_sim_cart_51to100_no2678910.Rdata\")\n\n",
    "created" : 1492731026724.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1415974211",
    "id" : "806FE8D0",
    "lastKnownWriteTime" : 1492616340,
    "last_content_update" : 1492616340,
    "path" : "~/GitHub/diss_paper/analyses/missing_sim_cart_1to50_2679.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}